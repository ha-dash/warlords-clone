# Активный Контекст

**Дата последнего обновления**: 2025-12-26 20:48

## Текущий Фокус

**Инициализация Memory Bank и применение правил livedocs**: Создание структуры документации согласно методологии "Живая Документация" для поддержания контекста между сессиями ИИ-агента.

**Текущая задача**: ✅ **ЗАВЕРШЕНА** - Миграция редактора карт на Next.js 16 + React 19 с TypeScript.

**Принят гибридный подход**: Основной проект остается на Vanilla JS, только редактор карт мигрирует на React/Next.js. Это минимизирует риски и сохраняет производительность игровой логики.

## Активные Задачи

- [x] Настроить Next.js 16 + React 19 проект
- [x] Установить и настроить Shadcn/ui компоненты
- [x] Создать TypeScript версии Map и Hex классов
- [x] Создать React компонент MapEditor с Three.js интеграцией
- [x] Адаптировать ModelLoader для Next.js
- [x] Создать UI компоненты редактора (панели, кнопки)
- [x] Настроить пути к assets из основного проекта (симлинк)
- [x] Настроить Biome для линтинга
- [x] Настроить Bun как пакетный менеджер
- [x] Изучить и применить правила livedocs

## Контекст Сессии

### Недавние изменения

1. **Создана структура Memory Bank**: Инициализированы все необходимые файлы документации согласно методологии livedocs
2. **Заполнены базовые документы**: Все файлы Memory Bank созданы и заполнены
3. **✅ Завершена миграция редактора карт на Next.js**:
   - Создан React компонент `MapEditor.tsx` с полной интеграцией Three.js
   - Адаптирован `ModelLoader` для Next.js с динамическими импортами
   - Созданы UI компоненты на Shadcn/ui (Toolbar, Sidebar, Card, Button, Input, Select)
   - Настроен симлинк для доступа к assets из `editor-nextjs/public/assets`
   - Установлены все необходимые зависимости (class-variance-authority, lucide-react)
   - Настроен Turbopack для ускорения dev сборки
   - Исправлены все ошибки TypeScript и линтера (Biome)
   - Проект успешно собирается

### Открытые вопросы

Все вопросы решены:
- ✅ ModelLoader адаптирован с динамическими импортами для Next.js
- ✅ Пути к assets настроены через симлинк `editor-nextjs/public/assets -> ../../assets`

### Принятые решения

1. **Memory Bank в корне проекта**: Используем `.memory_bank/` в корне для единой документации всего проекта
2. **Гибридная архитектура**: Основной проект остается на Vanilla JS, только редактор карт мигрирует на Next.js 16 + React 19
3. **TypeScript для игровой логики**: Общие классы (`Map`, `Hex`) портируются в TypeScript в `editor-nextjs/lib/game/`
4. **Bun для editor-nextjs**: Используем Bun как более быстрый пакетный менеджер (в 3-4 раза быстрее npm)
5. **Biome для линтинга**: Заменил ESLint+Prettier (в 10-100 раз быстрее)
6. **Turbopack**: Добавлен как bundler по умолчанию (в 10-700 раз быстрее webpack для dev)
7. **Shadcn/ui тема**: Maia style, Cyan theme, Large radius, Public Sans font, темная тема по умолчанию

## Следующие Шаги

1. **Завершить создание Memory Bank**: Заполнить `progress.md` с текущим git хэшем
2. **Продолжить миграцию редактора**: Создать React компонент `MapEditor` с интеграцией Three.js
3. **Адаптировать ModelLoader**: Портировать или адаптировать `ModelLoader` для Next.js
4. **Создать UI панели**: Реализовать панели инструментов редактора на React + Shadcn/ui
5. **Настроить пути к assets**: Обеспечить доступ к 3D моделям из редактора

## Важные Заметки

- **Правила livedocs**: Отныне перед началом каждой задачи нужно читать `activeContext.md` для понимания контекста
- **Обновление документации**: После каждого значимого изменения обновлять соответствующие файлы Memory Bank
- **Git хэш**: В `progress.md` должен быть актуальный хэш последнего коммита для отслеживания изменений

